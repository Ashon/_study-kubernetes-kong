# k8s kong-api gateway

k8s로 올라가는 리소스 yml들이 저장되어 있음.

k8s namespace 별로 디렉토리가 나눠져 있음.

## k8s/kong-apigw

``` txt
+=< namespace_kong-apigw.yml >============================================+
|                                                                         |
|  +=< svc_kong-database.yml >==+           +< job_kong-migration.yml >+  |
|  |                            |           |                          |  |
|  |    +------------------+    |           |  +-------------------+   |  |
|  |    | po/kong-database |    |           |  | po/kong-migration |   |  |
|  |    +------------------+    |           |  +-------------------+   |  |
|  |             |              |           |            |             |  |
|  |             | :5432        |           |            |             |  |
|  |    +--------V----------+   |           |  +--------------------+  |  |
|  |    | svc/kong-database | <--- migrate --- | job/kong-migration |  |  |
|  |    +--------+----------+   |           |  +--------------------+  |  |
|  |             |              |           |                          |  |
|  +=============|==============+           +==========================+  |
|                | ClusterIP:5432                                         |
|                |                                                        |
|              +-----------------+                                        |
|              |                 |                                        |
|  +========< deploy_kong-apigw.yml >============+                        |
|  |           |                 |               |                        |
|  |  +-----------------+ +-----------------+    |                        |
|  |  | po/kong-apigw-1 | | po/kong-apigw-2 | .. |                        |
|  |  +-----------------+ +-----------------+    |                        |
|  |          |                  |               |                        |
|  |          +------------------+               |                        |
|  |            |                                |                        |
|  +============|================================+                        |
|               | ContainerPort :8000,  :8001,  :8443,  :8444             |
|               | ServicePort   :10080, :10082, :10443, :10444            |
|               |                                                         |
|  +=< svc_kong-apigw.yml >=+   +=< ingress_kong-apigw.yml >=+            |
|  |            |           |   |                            |            |
|  |  +----------------+    |   |   +--------------------+   |            |
|  |  | svc/kong-apigw |------------| ingress-kong-apigw |   |            |
|  |  +----------------+    |   |   +--------------------+   |            |
|  |                        |   |            |               |            |
|  +========================+   +============|===============+            |
|                                            |                            |
+=========================================== | ===========================+
                                             |
                                             | 10080 -> apigw.pong.com:80
minikube                                     | 10081 -> apigw-admin.pong.com:80
                                             |
       ===================================== | ========
                                             V
external
```
